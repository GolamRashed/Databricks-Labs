# Databricks notebook source
# MAGIC %sh
# MAGIC nc -vz servercdghmll2q66im.database.windows.net 1433

# COMMAND ----------

jdbcUrl = "jdbc:sqlserver://servercdghmll2q66im.database.windows.net:1433;database=metastore0;encrypt=true;trustServerCertificate=false;hostNameInCertificate=*.database.windows.net;loginTimeout=30;"
connectionProperties = {
  "user" : "hdi@servercdghmll2q66im",
  "password" : "Abc!1234567890",
  "driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
}

# COMMAND ----------

pushdown_query = "(select * from employees where emp_no < 10008) emp_alias"
df = spark.read.jdbc(url=jdbcUrl, table=pushdown_query, properties=connectionProperties)
display(df)

# COMMAND ----------



# Username to use against metastore database
spark.hadoop.javax.jdo.option.ConnectionUserName hdi@servercdghmll2q66im

# Password to use against metastore database
spark.hadoop.javax.jdo.option.ConnectionPassword Abc!1234567890

# Driver class name for a JDBC metastore
spark.hadoop.javax.jdo.option.ConnectionDriverName com.microsoft.sqlserver.jdbc.SQLServerDriver

# Spark specific configuration options
spark.sql.hive.metastore.version 1.2.1
spark.sql.hive.metastore.jars builtin
hive.metastore.schema.verification.record.version true

# COMMAND ----------

